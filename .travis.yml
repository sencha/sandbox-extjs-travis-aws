language: node_js
node_js:
 - "lts/*"

cache:
  npm: false

before_install:
  # NPM Login - commercial
  # - npm config set @sencha:registry https://npm.sencha.com/
  # - npm config set //npm.sencha.com/:_authToken=$SENCHA_NPM_TOKEN_VERDACCIO
  # NPM Login - early-adopter
  - npm config set @sencha:registry https://sencha.myget.org/F/early-adopter/npm/
  - npm config set //sencha.myget.org/F/early-adopter/npm/:_authToken=$SENCHA_NPM_TOKEN_EARLYADOPTER
  # For early adopter clean the cache 
  # Remove all package-lock.json files for early adopter. 
  #- npm cache clean --force
  #- npm cache verify

install: 
  - npm install
  - ls
  - pwd
  - cd ./client
  - pwd
  - npm install

script:
  - pwd
  - npm run build
  # Next steps are handeled in the Dockerfile
  # DockerFile is doing the copying to html directory
  #- cp -R ./client/build/production/ModernApp/* ./server/html

# deploy:
#   provider: elasticbeanstalk
#   access_key_id:
#     secure: "Encrypted <access-key-id>="
#   secret_access_key:
#     secure: "Encypted <secret-access-key>="
#   region: "us-east-1"
#   app: "sandbox-extjs-travis-aws"
#   env: "sandbox-staging"
#   bucket_name: "the-target-S3-bucket"


# Notes:
# https://travis-ci.com/github/sencha/sandbox-extjs-travis-aws/settings - contains private export variables

# Run Travis CLI in this repo
# gem install travis

# Delete Travis Cache
# travis cache --com
# travis cache --com --delete